---
title: "MB5370 Module 4 - QFISH_report"
author: "Tory Pritchard"
date: "2024-05-16"
output: html_document
---

#____________________________________________________________________________

Workspace/Rmd file location
C:/Users/Admin/OneDrive/Documents/MB5370/Module_04/Mod4_Personal/QFISH_report.Rmd
File also in Git hub!

Description: This assignment uses real-world marine data collected as part of Queensland fisheries QFISH database to develop a report.

#____________________________________________________________________________

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

load required packages
```{r}
library(DataViz)
library(palmerpenguins)
library(ggthemes)
library(readr)
library(tidyverse)
```


### Part 1: Obtain data

[Shark Control Program](https://qfish.fisheries.qld.gov.au/query/number-caught-by-area-calendar-year-and-species-group/table)

Data was first downloaded from the above link. However, after viewing the data in excel, I went back to the above link and customized how the data was sorted so there were less NA values and blank cells. It was exported as Comma Separated Values (CSV) and saved in Github repo [Mod4_Personal](https://github.com/tkpritch/Mod4_Personal.git)


### Part 2: Tidy data

Import dataset
```{r echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
shark <- read_csv("../data/sharkdatacustom.csv")
```


Delete rows with NA as they are just the rows that have the total numbers in them
```{r}
shark <- na.omit(shark)
```

Change column name so there are no spaces
```{r}
shark <- shark %>% rename(`Count` = `NumberCaught Total`)
```

Make sure data is assigned to the proper data type it is
```{r}
shark <- shark %>%
  mutate(Area = as.character(Area),
         SpeciesGroup = as.character(SpeciesGroup),
         CalendarYear = as.numeric(CalendarYear),
         Count = as.numeric(Count))
         
```



Create a bar plot showing catch data of the 4 groups over all the years
```{r}
ggplot(data = shark) +
  geom_bar(aes(x = SpeciesGroup, y = Count), stat = "identity")
```

Create a bar plot showing the areas where the species were caught
```{r}
ggplot(data = shark) +
  geom_bar(aes(x = SpeciesGroup, y = Count, fill = Area), stat = "identity")
```

Create a bar plot showing only the shark catch over the years 
```{r}
shark_filtered <- shark %>%
  filter(SpeciesGroup == "Shark")
         
ggplot(data = shark_filtered) +
  geom_bar(aes(x = CalendarYear, y = Count), stat = "identity") +
  labs(x = "Year",
       y = "Count")
```

Create a point plot showing the catch over the years 
```{r}
ggplot(data = shark) +
  geom_line(aes(x = CalendarYear, y = Count, colour = SpeciesGroup)) +
  labs(x = "Year",
       y = "Count")
```

Create a bar plot showing the areas where the species were caught
```{r}
ggplot(data = shark_filtered) +
  geom_bar(aes(x = Area, y = Count, fill = CalendarYear), stat = "identity") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```




```{r}
fishmeth <- read_csv("C:/Users/Admin/Downloads/export.csv")

filtered_fishmeth <- fishmeth %>%
  filter(!grepl("Total", CalendarYear)) %>%
  filter(CalendarYear != "2024 incomplete") %>%
  mutate_all(~ ifelse(. == "N/A", NA, .)) %>%
  mutate_all(~ ifelse(is.na(.), 0, .))

filtered_fishmeth$Tonnes <- as.numeric(gsub("[,]", "", filtered_fishmeth$Tonnes))

filtered_fishmeth <- filtered_fishmeth %>%
  mutate(Tonnes = as.numeric(Tonnes),
         CalendarYear = as.numeric(CalendarYear))

#exclude the fishing methods that are 0s
# List of fishing methods to exclude
methods_to_exclude <- c("Trap", "Other", "Diving", "Danish Seine", "Collection")

# Filter out the methods you want to exclude
filtered_meth <- filtered_fishmeth %>%
  filter(!FishingMethod %in% methods_to_exclude)

ggplot(data = filtered_meth) +
  geom_line(aes(x = CalendarYear, y = Tonnes, colour = FishingMethod)) +
  theme_minimal()
```









### Part 3: Plot 

![Shark Control Program](QFISHplot.png)

*detailed caption of what plot shows